import{r,j as e,a as j,L as v,P as y}from"./index-CAJCmpfN.js";const P=({onTypeSelect:c})=>{const[p,i]=r.useState([]),[n,o]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const a=await j.get("/register-store/product-types");console.log(a.data),i(a.data)}catch(a){console.error("Error fetching product types:",a)}})()},[]);const l=t=>{c(t),o(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`store-navbar ${n?"open":""}`,children:[e.jsx("button",{className:"close-button",onClick:()=>o(!1),children:"âœ•"}),e.jsxs("div",{className:"store-navbar-content",children:[e.jsx("button",{className:"all-products",onClick:()=>l("All"),children:"All Products"}),p.map((t,a)=>e.jsxs("div",{onClick:()=>l(t.type),className:"store-navbar-section",children:[e.jsxs("h2",{className:"store-navbar-title",onClick:()=>l(t.type),children:[t.type,"s"]}),e.jsx("div",{className:"thumbnail-container",children:Array.isArray(t.thumbnails)&&t.thumbnails.length>0?t.thumbnails.slice(0,3).map((m,d)=>e.jsx("img",{src:`https://api.bakersburns.com/uploads/${m}`,alt:`Thumbnail for ${t.type}`},`${t.type}-${d}`)):e.jsx("p",{children:"No products"})})]},`${t.type}-${a}`))]})]}),!n&&e.jsx("button",{className:"reopen-button",onClick:()=>o(!0),children:"Menu"})]})},$=()=>{const[c,p]=r.useState([]),[i,n]=r.useState([]),[o,l]=r.useState("All"),[t,a]=r.useState(null),[m,d]=r.useState(!0),[h,x]=r.useState(null);r.useEffect(()=>{g()},[]);const g=async()=>{d(!0),x(null);try{const s=await j.get("/register-store/products");p(s.data.products||[]),n(s.data.products||[])}catch(s){console.error("Error fetching products:",s),x("Failed to load products. Please try again later.")}finally{d(!1)}};r.useEffect(()=>{n(o==="All"?c:c.filter(s=>s.type===o))},[o,c]);const f=s=>{a(s)},b=()=>{a(null)};return m||h?e.jsxs("div",{className:"full-page-loading-overlay",children:[e.jsx(v,{}),h&&e.jsx("p",{style:{color:"red",position:"absolute",zIndex:"1000",fontSize:"1rem",bottom:"20%",backgroundColor:"white",padding:"10px",borderRadius:"10px"},children:h})]}):e.jsxs(e.Fragment,{children:[t&&e.jsx(y,{product:t,onClose:b}),e.jsx(P,{onTypeSelect:s=>l(s)}),e.jsx("div",{className:"store-container",children:e.jsx("div",{className:"store-product-grid",children:i.length>0?i.map(s=>{const u=s.isDiscounted,N=u?new Date(s.discountEndDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null;return e.jsxs("div",{className:"store-product-tile",onClick:()=>f(s),children:[e.jsxs("div",{className:"store-product-image",children:[e.jsx("img",{src:`https://api.bakersburns.com/uploads/${s.thumbnail}`,alt:s.name}),u&&e.jsx("div",{className:"store-discount-tag",children:s.discountType==="percentage"?`-${parseFloat(s.discountAmount).toFixed(2)}%`:`-$${parseFloat(s.discountAmount).toFixed(2)}`})]}),e.jsxs("div",{className:"store-product-info",children:[e.jsx("h3",{className:"store-product-info__title",children:s.name}),e.jsx("div",{className:"store-product-price",children:u?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"store-product-price__original",children:["$",parseFloat(s.price).toFixed(2)]}),e.jsxs("p",{className:"store-product-price__discounted",children:["$",parseFloat(s.discountPrice).toFixed(2)]})]}):e.jsxs("p",{className:"store-product-price__active",children:["$",parseFloat(s.price).toFixed(2)]})}),u&&e.jsxs("p",{className:"store-sale-end",children:["Sale Ends: ",N]})]})]},s.id)}):e.jsx("p",{className:"store-no-products",children:"No products available or still loading..."})})})]})};export{$ as default};
