import{j as e,L as A,r as o,a as S,u as T}from"./index-CIMy0-5x.js";import{L as E}from"./loading-h6YkDr8l.js";const B=({message:t,onClose:i})=>{const u=()=>{window.location.href="/store"};return e.jsx("div",{style:g.backdrop,onClick:i,children:e.jsxs("div",{style:g.modal,onClick:l=>l.stopPropagation(),children:[e.jsx("h3",{style:g.heading,children:"Item Added to Cart"}),e.jsx("p",{style:g.message,children:t}),e.jsxs("div",{style:g.buttonWrapper,children:[e.jsx(A,{to:"/cart",children:e.jsx("button",{style:g.cartButton,children:"Go to Cart"})}),e.jsx("button",{style:g.shopButton,onClick:u,children:"Keep Shopping"})]})]})})},g={backdrop:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{backgroundColor:"#fff",borderRadius:"10px",padding:"20px",textAlign:"center",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.2)",maxWidth:"300px",width:"90%"},heading:{fontSize:"1.5rem",marginBottom:"10px"},message:{fontSize:"1rem",color:"#555",marginBottom:"20px"},buttonWrapper:{display:"flex",justifyContent:"space-between",gap:"10px"},cartButton:{padding:"10px 15px",background:"linear-gradient(to right, #007bff, #0056b3)",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",flex:1},shopButton:{padding:"10px 15px",background:"linear-gradient(to right, #28a745, #218838)",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",flex:1}},L=({product:t,maxQuantity:i,onClose:u,onViewCart:l})=>{const[a,d]=o.useState(1),[r,c]=o.useState(!1),y=()=>{a<i&&d(a+1)},f=()=>{a>1&&d(a-1)},x=n=>{const p=parseInt(n.target.value,10);!p||p<1?d(1):p>i?d(i):d(p)},j=async()=>{const n=v();if(!n){alert("Session ID is missing. Unable to add to cart.");return}try{await S.post("/register-cart/add-guest-cart",{sessionId:n,productId:t.id,quantity:a}),c(!0),console.log(`${a} x ${t.name} added to cart!`)}catch(p){console.error("Error adding item to guest cart:",p),alert("An error occurred while adding the item to the cart. Please try again.")}},v=()=>{let n=localStorage.getItem("sessionId");return n||(n=`guest_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("sessionId",n)),n};return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:h.backdrop,onClick:u,children:e.jsxs("div",{style:h.modal,onClick:n=>n.stopPropagation(),children:[e.jsx("h3",{style:h.heading,children:"Select Quantity"}),e.jsxs("div",{style:h.quantityWrapper,children:[e.jsx("button",{style:h.button,onClick:f,children:"-"}),e.jsx("input",{type:"number",value:a,onChange:x,min:"1",max:i,style:h.input}),e.jsx("button",{style:h.button,onClick:y,children:"+"})]}),e.jsxs("p",{style:h.stockInfo,children:["Available: ",i]}),e.jsx("button",{style:h.addToCartButton,onClick:j,children:"Add to Cart"}),e.jsx("button",{style:h.cancelButton,onClick:u,children:"Cancel"})]})}),r&&e.jsx(B,{message:`${a} x ${t.name} added to your cart!`,onConfirm:l,onCancel:()=>c(!1)})]})},h={backdrop:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{backgroundColor:"#ffffff",borderRadius:"10px",textAlign:"center",padding:"30px 20px",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.2)",maxWidth:"400px",width:"90%",position:"relative"},heading:{fontSize:"1.5rem",marginBottom:"20px",color:"#333"},quantityWrapper:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"20px"},button:{display:"flex",alignItems:"center",justifyContent:"center",color:"white",padding:"0",fontSize:"1.5rem",background:"black",border:"1px solid #ccc",borderRadius:"5px",cursor:"pointer",width:"40px",height:"40px",lineHeight:"1"},input:{width:"60px",textAlign:"center",fontSize:"1rem",padding:"5px",border:"1px solid #ccc",borderRadius:"5px",marginTop:"15px"},stockInfo:{fontSize:"0.9rem",color:"#666",marginBottom:"20px"},addToCartButton:{padding:"10px 20px",background:"linear-gradient(to right, #28a745, #218838)",color:"#fff",fontSize:"1rem",border:"none",borderRadius:"5px",cursor:"pointer",margin:"10px"},cancelButton:{padding:"10px 20px",background:"linear-gradient(to right, #dc3545, #c82333)",color:"#fff",fontSize:"1rem",border:"none",borderRadius:"5px",cursor:"pointer"}},z=({product:t,onClose:i})=>{const[u,l]=o.useState(!1),[a,d]=o.useState(0),[r,c]=o.useState([]),[y,f]=o.useState(!0),[x,j]=o.useState(0),v=T(),n=t.isDiscounted,p=n?parseFloat(t.discountPrice).toFixed(2):null,s=n?new Date(t.discountEndDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null;o.useEffect(()=>{(async()=>{try{const I=(await S.get(`/register-store/products/${t.id}/media`)).data||[],$=[{id:"thumbnail",url:t.thumbnail,type:"image",order:0},...I.sort((M,D)=>M.order-D.order)];c($)}catch(N){console.error("Error fetching media:",N),c([{id:"thumbnail",url:t.thumbnail,type:"image",order:0}])}finally{f(!1)}})()},[t.id,t.thumbnail]);const b=()=>l(!0),C=()=>l(!1),k=()=>a<r.length-1&&d(m=>m+1),w=()=>a>0&&d(m=>m-1),P=m=>j(m.touches[0].clientX),F=m=>{const N=x-m.touches[0].clientX;N>50?k():N<-50&&w()};return e.jsx("div",{className:"product-modal-overlay",onClick:i,children:e.jsxs("div",{className:"product-modal-container",onClick:m=>m.stopPropagation(),children:[y?e.jsx("p",{className:"product-modal-loading",children:"Loading media..."}):r.length>0?e.jsxs("div",{className:"product-modal-carousel",onTouchStart:P,onTouchMove:F,children:[a>0&&e.jsx("button",{className:"product-modal-arrow left",onClick:w,children:"‹"}),e.jsx("div",{className:"product-modal-slide",children:r[a].type==="image"?e.jsx("img",{src:`https://api.bakersburns.com/uploads/${r[a].url}`,alt:`Media ${a+1}`,className:"product-modal-media"}):e.jsx("video",{src:`https://api.bakersburns.com/uploads/${r[a].url}`,controls:!0,className:"product-modal-media"})}),a<r.length-1&&e.jsx("button",{className:"product-modal-arrow right",onClick:k,children:"›"})]}):e.jsx("p",{className:"product-modal-no-media",children:"No media available."}),e.jsxs("div",{className:"product-modal-info",children:[e.jsx("div",{className:"form-section",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"product-modal-price",children:[e.jsx("span",{className:"product-modal-label",children:"Original Price: "}),e.jsxs("span",{className:"product-modal-original-price",children:["$",parseFloat(t.price).toFixed(2)]})]}),e.jsxs("p",{className:"product-modal-price",children:[e.jsx("span",{className:"product-modal-label",children:"Discounted Price: "}),e.jsxs("span",{className:"product-modal-discounted-price",children:["$",p]})]})]}):e.jsxs("p",{className:"product-modal-price",children:[e.jsx("span",{className:"product-modal-label",children:"Price: "}),e.jsxs("span",{className:"product-modal-normal-price",children:["$",parseFloat(t.price).toFixed(2)]})]})}),e.jsx("div",{className:"product-modal-button-container",children:e.jsx("button",{className:"product-modal-purchase-button",onClick:b,children:"Purchase"})}),e.jsx("div",{className:"product-modal-details-grid",children:e.jsxs("p",{className:"product-modal-sale-end",children:[e.jsx("span",{className:"sale-end-product-modal-label",children:"Sale Ends: "}),s]})}),e.jsxs("div",{className:"product-modal-details-grid",children:[e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label"}),e.jsx("h2",{className:"product-modal-title",children:t.name})]}),e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label",children:"Description:"}),e.jsx("div",{className:"grid-value product-modal-description",children:t.description})]}),e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label",children:"Dimensions:"}),e.jsxs("div",{className:"grid-value product-modal-dimension-content",children:[e.jsxs("p",{children:["Length: ",(t.length*2.54).toFixed(2)," cm | ",t.length," in"]}),e.jsxs("p",{children:["Width: ",(t.width*2.54).toFixed(2)," cm | ",t.width," in"]}),e.jsxs("p",{children:["Height: ",(t.height*2.54).toFixed(2)," cm | ",t.height," in"]})]})]}),e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label",children:"Weight:"}),e.jsxs("div",{className:"grid-value",children:[t.weight," lbs"]})]}),e.jsxs("div",{className:"grid-item",children:[e.jsx("div",{className:"grid-label",children:"Quantity Available:"}),e.jsx("div",{className:"grid-value",children:t.quantity})]})]})]}),u&&e.jsx(L,{product:t,maxQuantity:t.quantity,onClose:C,onAddToCart:()=>console.log("Added to cart!"),onViewCart:()=>v("/cart")})]})})},_=({onTypeSelect:t})=>{const[i,u]=o.useState([]),[l,a]=o.useState(!1);o.useEffect(()=>{(async()=>{try{const c=await S.get("/register-store/product-types");u(c.data)}catch(c){console.error("Error fetching product types:",c)}})()},[]);const d=r=>{t(r),a(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`store-navbar ${l?"open":""}`,children:[e.jsx("button",{className:"close-button",onClick:()=>a(!1),children:"✕"}),e.jsxs("div",{className:"store-navbar-content",children:[e.jsx("button",{className:"store-navbar-item all-products",onClick:()=>d("All"),children:"All Products"}),i.map(r=>e.jsx("button",{className:"store-navbar-item",onClick:()=>d(r),children:r},r))]})]}),!l&&e.jsx("button",{className:"reopen-button",onClick:()=>a(!0),children:"Menu"})]})},q=()=>{const[t,i]=o.useState([]),[u,l]=o.useState([]),[a,d]=o.useState("All"),[r,c]=o.useState(null),[y,f]=o.useState(!0),[x,j]=o.useState(null);o.useEffect(()=>{v()},[]);const v=async()=>{f(!0),j(null);try{const s=await S.get("/register-store/products");i(s.data.products||[]),l(s.data.products||[])}catch(s){console.error("Error fetching products:",s),j("Failed to load products. Please try again later.")}finally{f(!1)}};o.useEffect(()=>{l(a==="All"?t:t.filter(s=>s.type===a))},[a,t]);const n=s=>{c(s)},p=()=>{c(null)};return y||x?e.jsxs("div",{children:[e.jsx(E,{}),x&&e.jsx("p",{style:{color:"red"},children:x})]}):e.jsxs(e.Fragment,{children:[r&&e.jsx(z,{product:r,onClose:p}),e.jsx(_,{onTypeSelect:s=>d(s)}),e.jsx("div",{className:"store-container",children:e.jsx("div",{className:"store-product-grid",children:u.length>0?u.map(s=>{const b=s.isDiscounted,C=b?new Date(s.discountEndDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null;return e.jsxs("div",{className:"store-product-tile",onClick:()=>n(s),children:[e.jsxs("div",{className:"store-product-image",children:[e.jsx("img",{src:`https://api.bakersburns.com/uploads/${s.thumbnail}`,alt:s.name}),b&&e.jsx("div",{className:"store-discount-tag",children:s.discountType==="percentage"?`-${parseFloat(s.discountAmount).toFixed(2)}%`:`-$${parseFloat(s.discountAmount).toFixed(2)}`})]}),e.jsxs("div",{className:"store-product-info",children:[e.jsx("h3",{className:"store-product-info__title",children:s.name}),e.jsx("div",{className:"store-product-price",children:b?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"store-product-price__original",children:["$",parseFloat(s.price).toFixed(2)]}),e.jsxs("p",{className:"store-product-price__discounted",children:["$",parseFloat(s.discountPrice).toFixed(2)]})]}):e.jsxs("p",{className:"store-product-price__active",children:["$",parseFloat(s.price).toFixed(2)]})}),b&&e.jsxs("p",{className:"store-sale-end",children:["Sale Ends: ",C]})]})]},s.id)}):e.jsx("p",{className:"store-no-products",children:"No products available or still loading..."})})})]})};export{q as default};
