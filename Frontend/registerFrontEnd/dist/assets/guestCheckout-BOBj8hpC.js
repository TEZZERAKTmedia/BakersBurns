import{r as a,j as e,a as x}from"./index-BAeA1om1.js";const C=()=>{const[c,u]=a.useState([]),[n,g]=a.useState(""),[s,i]=a.useState({line1:"",city:"",state:"",postal_code:""}),[d,o]=a.useState(!1),[h,l]=a.useState(null);a.useEffect(()=>{(async()=>{try{const p=(JSON.parse(localStorage.getItem("cart"))||[]).map(m=>({productId:m.id,quantity:m.quantity}));if(p.length===0){u([]);return}const j=await x.post("/register-cart/items",{items:p});u(j.data.cartDetails||[])}catch(r){console.error("Failed to fetch cart items:",r),l("Failed to fetch cart items. Please try again.")}})()},[]);const y=async t=>{if(t.preventDefault(),o(!0),l(null),!n||!s.line1||!s.city||!s.state||!s.postal_code){l("Please fill out all the fields."),o(!1);return}try{const r=await x.post("/register-cart/create-checkout-session",{cartItems:c,guestEmail:n,shippingAddress:s});window.location.href=r.data.url}catch(r){console.error("Checkout error:",r),l("Failed to initiate checkout. Please try again.")}finally{o(!1)}};return e.jsxs("div",{className:"privacy-terms-container",children:[e.jsx("h2",{children:"Guest Checkout"}),h&&e.jsx("p",{className:"error-message",children:h}),e.jsxs("form",{onSubmit:y,children:[e.jsx("label",{children:"Email:"}),e.jsx("input",{type:"email",value:n,onChange:t=>g(t.target.value),placeholder:"Enter your email",required:!0}),e.jsx("label",{children:"Shipping Address:"}),e.jsx("input",{type:"text",placeholder:"Street Address",value:s.line1,onChange:t=>i({...s,line1:t.target.value}),required:!0}),e.jsx("input",{type:"text",placeholder:"City",value:s.city,onChange:t=>i({...s,city:t.target.value}),required:!0}),e.jsx("input",{type:"text",placeholder:"State",value:s.state,onChange:t=>i({...s,state:t.target.value}),required:!0}),e.jsx("input",{type:"text",placeholder:"Postal Code",value:s.postal_code,onChange:t=>i({...s,postal_code:t.target.value}),required:!0}),e.jsx("button",{type:"submit",disabled:d,children:d?"Processing...":"Proceed to Payment"})]}),e.jsxs("div",{className:"cart-summary",children:[e.jsx("h3",{children:"Cart Summary"}),c.length>0?c.map(t=>e.jsxs("div",{className:"cart-item",children:[e.jsxs("p",{children:[e.jsx("strong",{children:t.name})," x ",t.quantity]}),e.jsxs("p",{children:["$",(t.price/100).toFixed(2)]})]},t.id)):e.jsx("p",{children:"Your cart is empty."})]})]})};export{C as default};
